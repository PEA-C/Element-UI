"use strict";(self["webpackChunkmy_elementui_project"]=self["webpackChunkmy_elementui_project"]||[]).push([[711],{8711:function(e,t,r){r.r(t),r.d(t,{default:function(){return w}});var a=function(){var e=this,t=e._self._c;return t("div",{staticClass:"article-page"},[t("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[t("el-breadcrumb-item",[e._v("面经后台")]),t("el-breadcrumb-item",[e._v("面经管理")])],1),t("el-card",{attrs:{shadow:"never",border:"false"},scopedSlots:e._u([{key:"header",fn:function(){return[t("div",{staticClass:"header"},[t("span",[e._v("共 "+e._s(e.total)+" 条记录")]),t("el-button",{attrs:{icon:"el-icon-plus",size:"small",type:"primary",round:""},on:{click:function(t){return e.openDrawer("add")}}},[e._v(" 添加面经 ")])],1)]},proxy:!0}])},[t("el-table",{staticStyle:{width:"100%"},attrs:{stripe:"",data:e.list}},[t("el-table-column",{attrs:{prop:"stem",label:"标题",width:"400"}}),t("el-table-column",{attrs:{prop:"creator",label:"作者"}}),t("el-table-column",{attrs:{prop:"likeCount",label:"点赞"}}),t("el-table-column",{attrs:{prop:"views",label:"浏览数"}}),t("el-table-column",{attrs:{prop:"createdAt",label:"更新时间",width:"200"}}),t("el-table-column",{attrs:{label:"操作",width:"120px"},scopedSlots:e._u([{key:"default",fn:function({row:r}){return[t("div",{staticClass:"actions"},[t("i",{staticClass:"el-icon-view",on:{click:function(t){return e.openDrawer("preview",r.id)}}}),t("i",{staticClass:"el-icon-edit-outline",on:{click:function(t){return e.openDrawer("edit",r.id)}}}),t("i",{staticClass:"el-icon-delete",on:{click:function(t){return e.del(r.id)}}})])]}}])})],1)],1),t("el-pagination",{attrs:{"current-page":e.current,"page-sizes":[10,15,20,50],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),t("el-drawer",{attrs:{visible:e.isShowDrawer,size:"45%",title:e.drawerTitle,direction:"rtl","before-close":e.handleClose},on:{"update:visible":function(t){e.isShowDrawer=t}}},["preview"===e.drawerType?t("div",{staticClass:"article-preview"},[t("h5",[e._v(e._s(e.form.stem))]),t("div",{domProps:{innerHTML:e._s(e.form.content)}})]):t("el-form",{ref:"form",attrs:{"label-width":"80px",model:e.form,rules:e.rules}},[t("el-form-item",{attrs:{label:"标题",prop:"stem"}},[t("el-input",{attrs:{placeholder:"输入面经标题"},model:{value:e.form.stem,callback:function(t){e.$set(e.form,"stem",t)},expression:"form.stem"}})],1),t("el-form-item",{attrs:{label:"内容",prop:"content"}},[t("quill-editor",{on:{blur:function(t){return e.$refs.form.validateField("content")}},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("确认")]),t("el-button",{on:{click:e.handleClose}},[e._v("取消")])],1)],1)],1)],1)},s=[],i=r(8353);const n=e=>(0,i.A)({url:"/admin/interview/query",params:e}),o=e=>i.A.post("/admin/interview/create",e),l=e=>i.A.delete("/admin/interview/remove",{data:{id:e}}),c=e=>i.A.get("/admin/interview/show",{params:{id:e}}),d=({id:e,stem:t,content:r})=>i.A.put("/admin/interview/update",{id:e,stem:t,content:r});var u={name:"article-page",data(){return{current:1,pageSize:10,total:0,list:[],isShowDrawer:!1,drawerType:"",form:{stem:"",content:""},tableData:[],rules:{stem:[{required:!0,message:"请输入面经标题",trigger:"blur"}],content:[{required:!0,message:"请输入面经标题",trigger:"blur"}]}}},created(){this.initData()},computed:{drawerTitle(){let e="";return"add"===this.drawerType&&(e="添加面经"),"preview"===this.drawerType&&(e="面经预览"),"edit"===this.drawerType&&(e="修改面经"),e}},methods:{async initData(){const e=await n({current:this.current,pageSize:this.pageSize});this.list=e.data.rows,this.total=e.data.total,console.log(e)},handleCurrentChange(e){this.current=e,this.initData()},handleSizeChange(e){console.log("每页几条数据",e),this.pageSize=e,this.initData()},async openDrawer(e,t){if(this.drawerType=e,this.isShowDrawer=!0,"add"!==e){console.log(e,t);const r=await c(t);console.log(r.data),this.form={...r.data}}},handleClose(){this.form={stem:"",content:""},"preview"!==this.drawerType&&this.$refs.form.resetFields(),this.isShowDrawer=!1},onSubmit(){this.$refs.form.validate((async e=>{if(e)try{if("add"===this.drawerType&&(await o(this.form),this.$message.success("添加成功")),"edit"===this.drawerType){const{id:e,stem:t,content:r}=this.form;await d({id:e,stem:t,content:r}),this.$message.success("修改成功")}this.handleClose(),this.initData(),this.current=1}catch(t){t.response?this.$message.error(t.response.data.message):("add"===this.drawerType&&this.$message.error("添加失败"),"edit"===this.drawerType&&this.$message.error("修改失败"))}}))},async del(e){try{await l(e),this.$message.success("删除成功"),this.initData(),1===this.pageSize.length&&this.current>1&&this.current--}catch(t){t.response?this.$message.error(t.response.data.message):this.$message.error("删除失败")}}}},m=u,p=r(1656),h=(0,p.A)(m,a,s,!1,null,"399aefc1",null),w=h.exports}}]);